![image](https://github.com/udayk01/Web-Security/assets/52235763/8ee9ac07-e472-4d27-810b-3d1c63150df5)

## Solution:

> Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.

![image](https://github.com/udayk01/Web-Security/assets/52235763/835b68a2-9beb-4d27-b976-a94937ce183f)

![image](https://github.com/udayk01/Web-Security/assets/52235763/6a292789-3811-4558-a8f1-be5860c131df)

![image](https://github.com/udayk01/Web-Security/assets/52235763/a8bfaa5f-98b3-40a9-ab30-269c63385f1a)

> Try tampering with the stockApi parameter and observe that it isn't possible to make the server issue the request directly to a different host.

![image](https://github.com/udayk01/Web-Security/assets/52235763/deca6982-80c7-493c-a0a1-9c479427d55f)

> Click "next product" and observe that the path parameter is placed into the Location header of a redirection response, resulting in an open redirection.

![image](https://github.com/udayk01/Web-Security/assets/52235763/df14a00f-479f-4061-ac99-8fc773f8488c)

> Create a URL that exploits the open redirection vulnerability, and redirects to the admin interface, and feed this into the stockApi parameter on the stock checker:

```/product/nextProduct?path=http://192.168.0.12:8080/admin```

![image](https://github.com/udayk01/Web-Security/assets/52235763/d06f7a4b-8aa7-4cb1-a698-3def2519eaa0)

> Observe that the stock checker follows the redirection and shows you the admin page.

![Screenshot 2024-04-20 095538](https://github.com/udayk01/Web-Security/assets/52235763/c552db9d-f17b-47cb-97ce-21c86ddf47b5)

> Amend the path to delete the target user:

```/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos```

![Screenshot 2024-04-20 095657](https://github.com/udayk01/Web-Security/assets/52235763/6a1f9eb7-0527-4863-abca-a611c44f6e68)

> Lab Solved

![image](https://github.com/udayk01/Web-Security/assets/52235763/a33745db-c742-4500-a728-3516393252c5)
